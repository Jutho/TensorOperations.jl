<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · TensorOperations.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.svg" alt="TensorOperations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>TensorOperations.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Table-of-contents"><span>Table of contents</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Package-features"><span>Package features</span></a></li><li><a class="tocitem" href="#Tensor-operations"><span>Tensor operations</span></a></li><li><a class="tocitem" href="#To-do-list"><span>To do list</span></a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="man/indexnotation/">Index notation with macros</a></li><li><a class="tocitem" href="man/functions/">Functions</a></li><li><a class="tocitem" href="man/interface/">Interface</a></li><li><a class="tocitem" href="man/autodiff/">Automatic differentiation</a></li><li><a class="tocitem" href="man/implementation/">Implementation</a></li></ul></li><li><a class="tocitem" href="index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Jutho/TensorOperations.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="TensorOperations.jl"><a class="docs-heading-anchor" href="#TensorOperations.jl">TensorOperations.jl</a><a id="TensorOperations.jl-1"></a><a class="docs-heading-anchor-permalink" href="#TensorOperations.jl" title="Permalink"></a></h1><p><em>Fast tensor operations using a convenient Einstein index notation.</em></p><h2 id="Table-of-contents"><a class="docs-heading-anchor" href="#Table-of-contents">Table of contents</a><a id="Table-of-contents-1"></a><a class="docs-heading-anchor-permalink" href="#Table-of-contents" title="Permalink"></a></h2><ul><li><a href="#TensorOperations.jl">TensorOperations.jl</a></li><li class="no-marker"><ul><li><a href="#Table-of-contents">Table of contents</a></li><li><a href="#Installation">Installation</a></li><li><a href="#Package-features">Package features</a></li><li><a href="#Tensor-operations">Tensor operations</a></li><li><a href="#To-do-list">To do list</a></li></ul></li><li><a href="man/indexnotation/#Index-notation-with-macros">Index notation with macros</a></li><li class="no-marker"><ul><li><a href="man/indexnotation/#The-@tensor-macro">The <code>@tensor</code> macro</a></li><li><a href="man/indexnotation/#Contraction-order-specification-and-optimisation">Contraction order specification and optimisation</a></li><li><a href="man/indexnotation/#Dynamical-tensor-network-contractions-with-ncon-and-@ncon">Dynamical tensor network contractions with <code>ncon</code> and <code>@ncon</code></a></li><li><a href="man/indexnotation/#Index-compatibility-and-checks">Index compatibility and checks</a></li><li><a href="man/indexnotation/#Backends,-multithreading-and-GPUs">Backends, multithreading and GPUs</a></li></ul></li><li><a href="man/functions/#Functions">Functions</a></li><li class="no-marker"><ul><li><a href="man/functions/#Non-mutating-functions">Non-mutating functions</a></li><li><a href="man/functions/#Mutating-functions">Mutating functions</a></li></ul></li><li><a href="man/autodiff/#Automatic-differentiation">Automatic differentiation</a></li><li><a href="man/interface/#Interface">Interface</a></li><li class="no-marker"><ul><li><a href="man/interface/#Operations">Operations</a></li><li><a href="man/interface/#Allocations">Allocations</a></li><li><a href="man/interface/#Utility">Utility</a></li></ul></li><li><a href="man/implementation/#Implementation">Implementation</a></li><li class="no-marker"><ul><li><a href="man/implementation/#Verifiers">Verifiers</a></li><li><a href="man/implementation/#Preprocessing">Preprocessing</a></li><li><a href="man/implementation/#Processing">Processing</a></li><li><a href="man/implementation/#Postprocessing">Postprocessing</a></li><li><a href="man/implementation/#Analysis-of-contraction-graphs-and-optimizing-contraction-order">Analysis of contraction graphs and optimizing contraction order</a></li></ul></li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>Install with the package manager, <code>pkg&gt; add TensorOperations</code>.</p><h2 id="Package-features"><a class="docs-heading-anchor" href="#Package-features">Package features</a><a id="Package-features-1"></a><a class="docs-heading-anchor-permalink" href="#Package-features" title="Permalink"></a></h2><p>The TensorOperations.jl package is centered around the following features:</p><ul><li>A macro <a href="man/indexnotation/#TensorOperations.@tensor"><code>@tensor</code></a> for conveniently specifying tensor contractions and index permutations via Einstein&#39;s index notation convention. The index notation is analyzed at compile time and lowered into primitive tensor operations, namely (permuted) linear combinations and inner and outer contractions. The macro supports several keyword arguments to customize the lowering process, namely to insert additional checks that help with debugging, to specify contraction order or to automatically determine optimal contraction order for given costs (see next bullet), and finally, to select different backends to evaluate those primitive operations.</li><li>The ability to optimize pairwise contraction order in complicated tensor contraction networks according to the algorithm in <a href="https://doi.org/10.1103/PhysRevE.90.033315">this paper</a>, where custom (compile time) costs can be specified, either as a keyword to <a href="man/indexnotation/#TensorOperations.@tensor"><code>@tensor</code></a> or using the <a href="man/indexnotation/#TensorOperations.@tensoropt"><code>@tensoropt</code></a> macro (for expliciteness and backward compatibility). This optimization is performed at compile time, and the resulting contraction order is hard coded into the resulting expression. The similar macro <code>@tensoropt_verbose</code> provides more information on the optimization process.</li><li>A function <code>ncon</code> (for network contractor) for contracting a group of tensors (a.k.a. a tensor network), as well as a corresponding <code>@ncon</code> macro that simplifies and optimizes this slightly. Unlike the previous macros, <code>ncon</code> and <code>@ncon</code> do not analyze the contractions at compile time, thus allowing them to deal with dynamic networks or index specifications.</li><li>(Experimental) support for automatic differentiation by supplying chain rules for the different tensor operations using the <code>ChainRules.jl</code> interface.</li><li>The ability to support different tensor types by overloading a minimal interface of tensor operations, or to support different implementation backends for the same tensor type.</li><li>An efficient default implementation for Julia Base arrays that qualify as strided, i.e. such that its entries are layed out according to a regular pattern in memory. The only exceptions are <code>ReinterpretedArray</code> objects. Additionally, <code>Diagonal</code> objects whose underlying diagonal data is stored as a strided vector are supported. This facilitates tensor contractions where one of the operands is e.g. a diagonal matrix of singular values or eigenvalues, which are returned as a <code>Vector</code> by Julia&#39;s <code>eigen</code> or <code>svd</code> method. This implementation for <code>AbstractArray</code> objects is based on <a href="https://github.com/Jutho/Strided.jl">Strided.jl</a> for efficient (cache-friendly and multithreaded) tensor permutations (transpositions) and <code>gemm</code> from BLAS for contractions. There is also a fallback contraction strategy that is natively built using Strided.jl, e.g. for scalar types which are not supported by BLAS. Additional backends (e.g. pure Julia Base using loops and/or broadcasting) may be added in the future.</li><li>Support for <code>CuArray</code> objects if used together with <a href="https://github.com/JuliaGPU/CUDA.jl">CUDA.jl and cuTENSOR.jl</a>, by relying on (and thus providing a high level interface into) NVidia&#39;s <a href="https://developer.nvidia.com/cutensor">cuTENSOR</a> library.</li></ul><h2 id="Tensor-operations"><a class="docs-heading-anchor" href="#Tensor-operations">Tensor operations</a><a id="Tensor-operations-1"></a><a class="docs-heading-anchor-permalink" href="#Tensor-operations" title="Permalink"></a></h2><p>TensorOperations.jl supports 3 basic tensor operations, i.e. primitives in which every more complicated tensor expression is deconstructed.</p><ol><li><strong>addition:</strong> Add a (possibly scaled version of) one tensor to another tensor, where the indices of both arrays might appear in different orders. This operation combines normal tensor addition (or linear combination more generally) and index permutation. It includes as a special case copying one tensor into another with permuted indices.</li><li><strong>trace or inner contraction:</strong> Perform a trace/contraction over pairs of indices of a single tensor array, where the result is a lower-dimensional array.</li><li><strong>(outer) contraction:</strong> Perform a general contraction of two tensors, where some indices of one array are paired with corresponding indices in a second array.</li></ol><h2 id="To-do-list"><a class="docs-heading-anchor" href="#To-do-list">To do list</a><a id="To-do-list-1"></a><a class="docs-heading-anchor-permalink" href="#To-do-list" title="Permalink"></a></h2><ul><li>Add more backends, e.g. using pure Julia Base functionality, or using <a href="https://github.com/JuliaSIMD/LoopVectorization.jl">LoopVectorization.jl</a></li><li>Make it easier to modify the contraction order algorithm or its cost function (e.g. to optimize based on memory footprint) or to splice in runtime information.</li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="man/indexnotation/">Index notation with macros »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 4 August 2023 16:42">Friday 4 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
