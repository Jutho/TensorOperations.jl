<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Implementation · TensorOperations.jl</title><meta name="title" content="Implementation · TensorOperations.jl"/><meta property="og:title" content="Implementation · TensorOperations.jl"/><meta property="twitter:title" content="Implementation · TensorOperations.jl"/><meta name="description" content="Documentation for TensorOperations.jl."/><meta property="og:description" content="Documentation for TensorOperations.jl."/><meta property="twitter:description" content="Documentation for TensorOperations.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="TensorOperations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TensorOperations.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../indexnotation/">Index notation with macros</a></li><li><a class="tocitem" href="../functions/">Functions</a></li><li><a class="tocitem" href="../interface/">Interface</a></li><li><a class="tocitem" href="../backends/">Backends and Allocators</a></li><li><a class="tocitem" href="../autodiff/">Automatic differentiation</a></li><li class="is-active"><a class="tocitem" href>Implementation</a><ul class="internal"><li><a class="tocitem" href="#Verifiers"><span>Verifiers</span></a></li><li><a class="tocitem" href="#Preprocessing"><span>Preprocessing</span></a></li><li><a class="tocitem" href="#Processing"><span>Processing</span></a></li><li><a class="tocitem" href="#Postprocessing"><span>Postprocessing</span></a></li><li><a class="tocitem" href="#Analysis-of-contraction-graphs-and-optimizing-contraction-order"><span>Analysis of contraction graphs and optimizing contraction order</span></a></li></ul></li><li><a class="tocitem" href="../precompilation/">Precompilation</a></li></ul></li><li><a class="tocitem" href="../../index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Implementation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Implementation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Jutho/TensorOperations.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Jutho/TensorOperations.jl/blob/master/docs/src/man/implementation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h1><p>The <a href="../indexnotation/#TensorOperations.@tensor"><code>@tensor</code></a> macro and its relatives work as parsers for indexed tensor expressions. They transform these into a sequence of calls to the primitive tensor operations. This allows the support of custom types that implement the <a href="../interface/#Interface">Interface</a>. The actual implementation is achieved through the use of <code>TensorParser</code>, which provides the general framework to parse tensor expressions. The <code>@tensor</code> macro is then just a wrapper around this, which configures the default behavior and handles keyword arguments of the parser.</p><p>The <code>TensorParser</code> works by breaking down the parsing into three main phases. First, a basic check of the supplied expression is performed, to ensure that it is a valid tensor expression. Then, a number of preprocessing steps can be performed, which are used to standardize expressions, allow for syntactic sugar features, and can also be used as a hook for writing custom parsers. Then, the different contractions within the tensor expression are analyzed and processed, which rewrites the expression into a set of binary rooted trees. Then, the main step can be executed, namely transforming the whole expression into actual calls to the primitive tensor operations <a href="../functions/#TensorOperations.tensoradd!"><code>tensoradd!</code></a>, <a href="../functions/#TensorOperations.tensortrace!"><code>tensortrace!</code></a> and <a href="../functions/#TensorOperations.tensorcontract!"><code>tensorcontract!</code></a>, as well as calls to <a href="../interface/#TensorOperations.tensoralloc_add"><code>tensoralloc_add</code></a> and <a href="../interface/#TensorOperations.tensoralloc_contract"><code>tensoralloc_contract</code></a> to allocate the temporary and final tensors. For those, also the resulting scalar type needs to be determined. Finally, a number of postprocessing steps can be added, which are mostly used to clean up the resulting expression by flattening and by removing line number nodes, but also to incorporate the custom backend and allocation system.</p><h2 id="Verifiers"><a class="docs-heading-anchor" href="#Verifiers">Verifiers</a><a id="Verifiers-1"></a><a class="docs-heading-anchor-permalink" href="#Verifiers" title="Permalink"></a></h2><p>The basic checks are performed by <a href="#TensorOperations.verifytensorexpr"><code>verifytensorexpr</code></a>, which calls the verifiers <a href="#TensorOperations.isassignment"><code>isassignment</code></a>, <a href="#TensorOperations.isdefinition"><code>isdefinition</code></a>, <a href="#TensorOperations.istensor"><code>istensor</code></a>, <a href="#TensorOperations.istensorexpr"><code>istensorexpr</code></a> and <a href="#TensorOperations.isscalarexpr"><code>isscalarexpr</code></a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.verifytensorexpr" href="#TensorOperations.verifytensorexpr"><code>TensorOperations.verifytensorexpr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">verifytensorexpr(ex)</code></pre><p>Check that <code>ex</code> is a valid tensor expression and throw an <code>ArgumentError</code> if not. Valid tensor expressions satisfy one of the following (recursive) rules):</p><ul><li>The expression is a scalar expression or a tensor expression.</li><li>The expression is an assignment or a definition, and the left hand side and right hand side are valid tensor expressions or scalars.</li><li>The expression is a block, and all subexpressions are valid tensor expressions or scalars.</li></ul><p>See also <a href="#TensorOperations.istensorexpr"><code>istensorexpr</code></a> and <a href="#TensorOperations.isscalarexpr"><code>isscalarexpr</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/parser.jl#L41-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.isassignment" href="#TensorOperations.isassignment"><code>TensorOperations.isassignment</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isassignment(ex)</code></pre><p>Test if <code>ex</code> is an assignment expression, i.e. <code>ex</code> is of one of the forms:</p><pre><code class="nohighlight hljs">a = b
a += b
a -= b</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/verifiers.jl#L184-L192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.isdefinition" href="#TensorOperations.isdefinition"><code>TensorOperations.isdefinition</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isdefinition(ex)</code></pre><p>Test if <code>ex</code> is a definition expression, i.e. <code>ex</code> is of the form:</p><pre><code class="nohighlight hljs">a := b
a ≔ b</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/verifiers.jl#L195-L202">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.isindex" href="#TensorOperations.isindex"><code>TensorOperations.isindex</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isindex(ex)</code></pre><p>Test for a valid index, namely a symbol or integer, or an expression of the form <code>i′</code> where <code>i</code> is itself a valid index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/verifiers.jl#L6-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.istensor" href="#TensorOperations.istensor"><code>TensorOperations.istensor</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">istensor(ex)</code></pre><p>Test for a simple tensor object indexed by valid indices. This means an expression of the form:</p><pre><code class="nohighlight hljs">A[i, j, k, ...]
A[i j k ...]
A[i j k ...; l m ...]
A[(i, j, k, ...); (l, m, ...)]</code></pre><p>where <code>i</code>, <code>j</code>, <code>k</code>, ... are valid indices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/verifiers.jl#L22-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.istensorexpr" href="#TensorOperations.istensorexpr"><code>TensorOperations.istensorexpr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">istensorexpr(ex)</code></pre><p>Test for a tensor expression. This means an expression which can be evaluated to a valid     tensor. This includes:</p><pre><code class="nohighlight hljs">A[...] + B[...] - C[...] - ...
A[...] * B[...] * ...
λ * A[...] / μ
λ \ conj(A[...])
A[...]&#39; + adjoint(B[...]) - ...</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/verifiers.jl#L140-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.isscalarexpr" href="#TensorOperations.isscalarexpr"><code>TensorOperations.isscalarexpr</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isscalarexpr(ex)</code></pre><p>Test for a scalar expression, i.e. an expression that can be evaluated to a scalar.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/verifiers.jl#L113-L117">source</a></section></article><h2 id="Preprocessing"><a class="docs-heading-anchor" href="#Preprocessing">Preprocessing</a><a id="Preprocessing-1"></a><a class="docs-heading-anchor-permalink" href="#Preprocessing" title="Permalink"></a></h2><p>The following functions exist as preprocessors and are enabled in the default <code>TensorParser</code> objects.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.normalizeindices" href="#TensorOperations.normalizeindices"><code>TensorOperations.normalizeindices</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalizeindices(ex::Expr)</code></pre><p>Normalize indices of an expression by replacing all indices with a prime expression <code>i&#39;</code> by indices with a unicode prime &#39;i′&#39;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/preprocessors.jl#L49-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.expandconj" href="#TensorOperations.expandconj"><code>TensorOperations.expandconj</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">expandconj(ex)</code></pre><p>Expand all <code>conj</code> calls in an expression to conjugate the individual terms and factors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/preprocessors.jl#L73-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.nconindexcompletion" href="#TensorOperations.nconindexcompletion"><code>TensorOperations.nconindexcompletion</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nconindexcompletion(ex)</code></pre><p>Complete the indices of the left hand side of an ncon expression. For example, the following expressions are equivalent after index completion.</p><pre><code class="nohighlight hljs">@tensor A[:] := B[-1, 1, 2] * C[1, 2, -3]
@tensor A[-1, -2] := B[-1, 1, 2] * C[1, 2, -3]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/ncontree.jl#L60-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.extracttensorobjects" href="#TensorOperations.extracttensorobjects"><code>TensorOperations.extracttensorobjects</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">extracttensorobjects(ex)</code></pre><p>Extract all tensor objects which are not simple symbols with newly generated symbols, and assign them before the expression and after the expression as necessary, in order to avoid multiple evaluations of the expression constituting the tensor object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/preprocessors.jl#L106-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.insertcontractionchecks" href="#TensorOperations.insertcontractionchecks"><code>TensorOperations.insertcontractionchecks</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insertcontractionchecks(ex)</code></pre><p>Insert runtime checks before each contraction, which provide clearer debug information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/preprocessors.jl#L133-L137">source</a></section></article><h2 id="Processing"><a class="docs-heading-anchor" href="#Processing">Processing</a><a id="Processing-1"></a><a class="docs-heading-anchor-permalink" href="#Processing" title="Permalink"></a></h2><p>The following functions implement the main steps in parsing the tensor expression, and are always performed by any <code>TensorParser</code> object.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.processcontractions" href="#TensorOperations.processcontractions"><code>TensorOperations.processcontractions</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">processcontractions(ex, treebuilder, treesorter, costcheck)</code></pre><p>Process the contractions in <code>ex</code> using the given <code>treebuilder</code> and <code>treesorter</code> functions. This is done by first extracting a network representation from the expression, then building and sorting the contraction trees with a given <code>treebuilder</code> and <code>treesorter</code> function, and finally inserting the contraction trees back into the expression. When the <code>costcheck</code> argument equals <code>:warn</code> or <code>:cache</code> (as opposed to <code>:nothing</code>), the optimal contraction order is computed at runtime using the actual values of <a href="../interface/#TensorOperations.tensorcost"><code>tensorcost</code></a> and this optimal order is compared to the contraction order that was determined at compile time. If the compile time order deviated from the optimal order, a warning will be printed (in case of <code>costcheck == :warn</code>) or this particular contraction will be recorded in <code>TensorOperations.costcache</code> (in case of <code>costcheck == :cache</code>). Both the warning or the  recorded cache entry contain a <code>order</code> suggestion that can be passed to the <code>@tensor</code> macro in order to encode the optimal contraction order at compile time..</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/contractiontrees.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.tensorify" href="#TensorOperations.tensorify"><code>TensorOperations.tensorify</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tensorify(ex)</code></pre><p>Main parsing step to transform a tensor expression <code>ex</code> into a series of function calls associated with the primitive building blocks (tensor operations and allocations).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/parser.jl#L74-L79">source</a></section></article><h2 id="Postprocessing"><a class="docs-heading-anchor" href="#Postprocessing">Postprocessing</a><a id="Postprocessing-1"></a><a class="docs-heading-anchor-permalink" href="#Postprocessing" title="Permalink"></a></h2><p>The following functions exist as postprocessors and are enabled in the default <code>TensorParser</code> objects.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations._flatten" href="#TensorOperations._flatten"><code>TensorOperations._flatten</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_flatten(ex)</code></pre><p>Flatten nested structure of an expression, returning an unnested <code>Expr(:block, …)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/postprocessors.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.removelinenumbernode" href="#TensorOperations.removelinenumbernode"><code>TensorOperations.removelinenumbernode</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">removelinenumbernode(ex)</code></pre><p>Remove all <code>LineNumberNode</code>s from an expression.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/postprocessors.jl#L33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.addtensoroperations" href="#TensorOperations.addtensoroperations"><code>TensorOperations.addtensoroperations</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">addtensoroperations(ex)</code></pre><p>Fix references to TensorOperations functions in namespaces where <code>@tensor</code> is present but the functions are not.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/postprocessors.jl#L54-L58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.insertargument" href="#TensorOperations.insertargument"><code>TensorOperations.insertargument</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insertargument(ex, args, methods)</code></pre><p>Insert an extra argument into a tensor operation, e.g. for any <code>op</code> ∈ <code>methods</code>, transform <code>TensorOperations.op(args...)</code> -&gt; <code>TensorOperations.op(args..., arg)</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/postprocessors.jl#L70-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.insertbackend" href="#TensorOperations.insertbackend"><code>TensorOperations.insertbackend</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insertbackend(ex, backend)</code></pre><p>Insert the backend argument into the tensor operation methods <code>tensoradd!</code>, <code>tensortrace!</code>, and <code>tensorcontract!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/postprocessors.jl#L88-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="TensorOperations.insertallocator" href="#TensorOperations.insertallocator"><code>TensorOperations.insertallocator</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">insertallocator(ex, allocator)</code></pre><p>Insert the allocator argument into the tensor operation and allocation methods <code>tensoradd!</code>,  <code>tensortrace!</code>, <code>tensorcontract!</code>, <code>tensoralloc</code>, <code>tensoralloc_add</code>, <code>tensoralloc_contract</code> and <code>tensorfree!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/390aed8b3505efa449773e5b1f8865cbb906b258/src/indexnotation/postprocessors.jl#L97-L103">source</a></section></article><h2 id="Analysis-of-contraction-graphs-and-optimizing-contraction-order"><a class="docs-heading-anchor" href="#Analysis-of-contraction-graphs-and-optimizing-contraction-order">Analysis of contraction graphs and optimizing contraction order</a><a id="Analysis-of-contraction-graphs-and-optimizing-contraction-order-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis-of-contraction-graphs-and-optimizing-contraction-order" title="Permalink"></a></h2><p>The macro <a href="../indexnotation/#TensorOperations.@tensoropt"><code>@tensoropt</code></a> or the combination of <a href="../indexnotation/#TensorOperations.@tensor"><code>@tensor</code></a> with the keyword <code>opt</code> can be used to optimize the contraction order of the expression at compile time. This is done by analyzing the contraction graph, where the nodes are the tensors and the edges are the contractions, in combination with the data provided in <code>optdata</code>, which is a dictionary associating a cost (either a number or a polynomial in some abstract scaling parameter) to every index. This information is then used to determine the (asymptotically) optimal contraction tree (in terms of number of floating point operations). The algorithm that is used is described in <a href="https://arxiv.org/abs/1304.6112">arXiv:1304.6112</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../autodiff/">« Automatic differentiation</a><a class="docs-footer-nextpage" href="../precompilation/">Precompilation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Thursday 3 April 2025 13:11">Thursday 3 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
