<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>TensorOperations.jl · TensorOperations.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">TensorOperations.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Home</span><ul><li class="is-active"><a class="tocitem" href>TensorOperations.jl</a><ul class="internal"><li><a class="tocitem" href="#Table-of-contents"><span>Table of contents</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Package-features"><span>Package features</span></a></li><li><a class="tocitem" href="#Tensor-operations"><span>Tensor operations</span></a></li><li><a class="tocitem" href="#To-do-list"><span>To do list</span></a></li></ul></li><li><a class="tocitem" href="indexnotation/">Index notation with macros</a></li><li><a class="tocitem" href="functions/">Functions</a></li><li><a class="tocitem" href="cache/">Cache for temporaries</a></li><li><a class="tocitem" href="implementation/">Implementation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Home</a></li><li class="is-active"><a href>TensorOperations.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>TensorOperations.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Jutho/TensorOperations.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="TensorOperations.jl"><a class="docs-heading-anchor" href="#TensorOperations.jl">TensorOperations.jl</a><a id="TensorOperations.jl-1"></a><a class="docs-heading-anchor-permalink" href="#TensorOperations.jl" title="Permalink"></a></h1><p><em>Fast tensor operations using a convenient Einstein index notation.</em></p><h2 id="Table-of-contents"><a class="docs-heading-anchor" href="#Table-of-contents">Table of contents</a><a id="Table-of-contents-1"></a><a class="docs-heading-anchor-permalink" href="#Table-of-contents" title="Permalink"></a></h2><ul><li><a href="#TensorOperations.jl">TensorOperations.jl</a></li><ul><li><a href="#Table-of-contents">Table of contents</a></li><li><a href="#Installation">Installation</a></li><li><a href="#Package-features">Package features</a></li><li><a href="#Tensor-operations">Tensor operations</a></li><li><a href="#To-do-list">To do list</a></li></ul><li><a href="indexnotation/#Index-notation-with-macros">Index notation with macros</a></li><ul><li><a href="indexnotation/#The-@tensor-macro">The <code>@tensor</code> macro</a></li><li><a href="indexnotation/#Contraction-order-and-@tensoropt-macro">Contraction order and <code>@tensoropt</code> macro</a></li><li><a href="indexnotation/#Dynamical-tensor-network-contractions-with-ncon-and-@ncon">Dynamical tensor network contractions with <code>ncon</code> and <code>@ncon</code></a></li><li><a href="indexnotation/#Multithreading-and-GPU-evaluation-of-tensor-contractions-with-@cutensor">Multithreading and GPU evaluation of tensor contractions with <code>@cutensor</code></a></li></ul><li><a href="functions/#Functions">Functions</a></li><li><a href="cache/#Cache-for-temporaries">Cache for temporaries</a></li><ul><li><a href="cache/#Enabling-and-disabling-the-cache">Enabling and disabling the cache</a></li><li><a href="cache/#Cache-and-multithreading">Cache and multithreading</a></li></ul><li><a href="implementation/#Implementation">Implementation</a></li><ul><li><a href="implementation/#Index-notation-and-the-@tensor-macro">Index notation and the <code>@tensor</code> macro</a></li><ul><li><a href="implementation/#Tensors,-a.k.a-indexed-objects">Tensors, a.k.a indexed objects</a></li><li><a href="implementation/#The-macros-@tensor-and-@tensoropt">The macros <code>@tensor</code> and <code>@tensoropt</code></a></li><li><a href="implementation/#Analyzing-contraction-graphs-(a.k.a-tensor-networks)-and-optimizing-contraction-order">Analyzing contraction graphs (a.k.a tensor networks) and optimizing contraction order</a></li></ul><li><a href="implementation/#Building-blocks">Building blocks</a></li></ul></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>Install with the package manager, <code>pkg&gt; add TensorOperations</code>.</p><h2 id="Package-features"><a class="docs-heading-anchor" href="#Package-features">Package features</a><a id="Package-features-1"></a><a class="docs-heading-anchor-permalink" href="#Package-features" title="Permalink"></a></h2><ul><li>A macro <code>@tensor</code> for conveniently specifying tensor contractions and index permutations   via Einstein&#39;s index notation convention. The index notation is analyzed at compile time.</li><li>Ability to   <a href="https://doi.org/10.1103/PhysRevE.90.033315">optimize pairwise contraction order</a>   using the <code>@tensoropt</code> macro. This optimization is performed at compile time, and the resulting contraction order is hard coded into the resulting expression. The similar macro <code>@tensoropt_verbose</code> provides more information on the optimization process.</li><li>A function <code>ncon</code> (for network contractor) for contracting a group of   tensors (a.k.a. a tensor network), as well as a corresponding <code>@ncon</code> macro that   simplifies and optimizes this slightly. Unlike the previous macros, <code>ncon</code> and <code>@ncon</code>   do not analyze the contractions at compile time, thus allowing them to deal with   dynamic networks or index specifications.</li><li>Support for any Julia Base array which qualifies as strided, i.e. such that its entries   are layed out according to a regular pattern in memory. The only exception are   <code>ReinterpretedArray</code> objects (implementation provided by Strided.jl, see below).   Additionally, <code>Diagonal</code> objects whose underlying diagonal data is stored as a strided   vector are supported. This facilitates tensor contractions where one of the operands is   e.g. a diagonal matrix of singular values or eigenvalues, which are returned as a   <code>Vector</code> by Julia&#39;s <code>eigen</code> or <code>svd</code> method.</li><li>Support for <code>CuArray</code> objects if used together with CUDA.jl, by relying   on (and thus providing a high level interface into) NVidia&#39;s   <a href="https://developer.nvidia.com/cutensor">cuTENSOR</a> library.</li><li>Implementation can easily be extended to other types, by overloading a small set of   methods.</li><li>Efficient implementation of a number of basic tensor operations (see below), by relying   on <a href="https://github.com/Jutho/Strided.jl">Strided.jl</a> and <code>gemm</code> from BLAS for   contractions. The latter is optional but on by default, it can be controlled by a   package wide setting via <code>enable_blas()</code> and <code>disable_blas()</code>. If BLAS is disabled or   cannot be applied (e.g. non-matching or non-standard numerical types), Strided.jl is   also used for the contraction.</li><li>A package wide cache for storing temporary arrays that are generated when evaluating   complex tensor expressions within the <code>@tensor</code> macro (based on the implementation of   <a href="https://github.com/JuliaCollections/LRUCache.jl">LRUCache</a>). By default, the cache is   allowed to use up to the minimum of either 1GB or 25% of the total memory.</li></ul><h2 id="Tensor-operations"><a class="docs-heading-anchor" href="#Tensor-operations">Tensor operations</a><a id="Tensor-operations-1"></a><a class="docs-heading-anchor-permalink" href="#Tensor-operations" title="Permalink"></a></h2><p>TensorOperations.jl is centered around 3 basic tensor operations, i.e. primitives in which every more complicated tensor expression is deconstructed.</p><ol><li><p><strong>addition:</strong> Add a (possibly scaled version of) one array to another array, where the  indices of the both arrays might appear in different orders. This operation combines  normal array addition and index permutation. It includes as a special case copying one  array into another with permuted indices.</p><p>The actual implementation is provided by <a href="https://github.com/Jutho/  Strided.jl">Strided.jl</a>, which contains multithreaded implementations and cache-friendly blocking  strategies for an optimal efficiency.</p></li><li><p><strong>trace or inner contraction:</strong> Perform a trace/contraction over pairs of indices of an  array, where the result is a lower-dimensional array. As before, the actual  implementation is provided by <a href="https://github.com/Jutho/Strided.jl">Strided.jl</a>.</p></li><li><p><strong>contraction:</strong> Performs a general contraction of two tensors, where some indices of  one array are paired with corresponding indices in a second array. This is typically  handled by first permuting (a.k.a. transposing) and reshaping the two input arrays such  that the contraction becomes equivalent to a matrix multiplication, which is then  performed by the highly efficient <code>gemm</code> method from BLAS. The resulting array might  need another reshape and index permutation to bring it in its final form.  Alternatively, a native Julia implementation that does not require the additional  transpositions (yet is typically slower) can be selected by using <code>disable_blas()</code>.</p></li></ol><h2 id="To-do-list"><a class="docs-heading-anchor" href="#To-do-list">To do list</a><a id="To-do-list-1"></a><a class="docs-heading-anchor-permalink" href="#To-do-list" title="Permalink"></a></h2><ul><li>Make it easier to check contraction order and to splice in runtime information, or   optimize based on memory footprint or other custom cost functions.</li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="indexnotation/">Index notation with macros »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 5 August 2021 23:31">Thursday 5 August 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
