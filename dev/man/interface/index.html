<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Interface · TensorOperations.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="TensorOperations.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TensorOperations.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../indexnotation/">Index notation with macros</a></li><li><a class="tocitem" href="../functions/">Functions</a></li><li class="is-active"><a class="tocitem" href>Interface</a><ul class="internal"><li><a class="tocitem" href="#Operations"><span>Operations</span></a></li><li><a class="tocitem" href="#Allocations"><span>Allocations</span></a></li><li><a class="tocitem" href="#Utility"><span>Utility</span></a></li></ul></li><li><a class="tocitem" href="../implementation/">Implementation</a></li><li><a class="tocitem" href="../autodiff/">Automatic differentiation</a></li></ul></li><li><a class="tocitem" href="../../index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Interface</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Interface</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Jutho/TensorOperations.jl/blob/master/docs/src/man/interface.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Interface"><a class="docs-heading-anchor" href="#Interface">Interface</a><a id="Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Interface" title="Permalink"></a></h1><p>TODO: read and fix some referencing issues</p><p>The <code>@tensor</code> macro rewrites tensor operations in terms of basic building blocks, such that any tensor type that implements the following interface can be supported. In these methods, <code>C</code> will indicate an output tensor which is changed in-place, while <code>A</code> and <code>B</code> denote input tensors that are left unaltered. <code>pC</code>, <code>pA</code> and <code>pB</code> denote an <code>Index2Tuple</code>, a tuple of two tuples that represents a permutation and partition of the original tensor indices. Finally, <code>conjA</code> and <code>conjB</code> are symbols that are used to indicate if the input tensor should be conjugated (<code>:C</code>) or used as-is (<code>:N</code>).</p><h2 id="Operations"><a class="docs-heading-anchor" href="#Operations">Operations</a><a id="Operations-1"></a><a class="docs-heading-anchor-permalink" href="#Operations" title="Permalink"></a></h2><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>tensoradd!(::Any, ::Index2Tuple, ::Any, ::Symbol, ::Number, ::Number)</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>tensortrace!(::Any, ::Index2Tuple, ::Any, ::Index2Tuple, ::Symbol, ::Number, ::Number)</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>tensorcontract!(::Any, ::Index2Tuple, ::Any, ::Index2Tuple, ::Symbol, ::Any, ::Index2Tuple, ::Symbol, ::Number, ::Number)</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="TensorOperations.tensorscalar" href="#TensorOperations.tensorscalar"><code>TensorOperations.tensorscalar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tensorscalar(C)</code></pre><p>Return the single element of a tensor-like object with zero indices or dimensions as a value of the underlying scalar type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/9975b3139399ad4c05a63e298433d5b099e15b5f/src/interface.jl#L60-L65">source</a></section></article><h2 id="Allocations"><a class="docs-heading-anchor" href="#Allocations">Allocations</a><a id="Allocations-1"></a><a class="docs-heading-anchor-permalink" href="#Allocations" title="Permalink"></a></h2><p>For some networks, it will be necessary to allocate output and/or intermediate tensors. This process is split into the following hierarchy of functions, where custom tensor types can opt in at different levels.</p><p>By default, the process is split into three steps.</p><p>First, the scalar type <code>TC</code> of the resulting tensor is determined. This is done by leveraging <a href="https://github.com/Jutho/VectorInterface.jl">VectorInterface.jl</a>&#39;s <code>scalartype</code>, and promoting the results along with the types of any scalars that are present.</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>TensorOperations.promote_add</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>TensorOperations.promote_contract</code>. Check Documenter&#39;s build log for details.</p></div></div><p>Then, the type and structure of the resulting tensor is determined. The former represents all the information that is contained within the type, while the latter adds the required runtime information (e.g. array sizes, ...).</p><article class="docstring"><header><a class="docstring-binding" id="TensorOperations.tensoradd_type" href="#TensorOperations.tensoradd_type"><code>TensorOperations.tensoradd_type</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tensoradd_type(TC, pC, A, conjA)</code></pre><p>Obtain <code>typeof(C)</code>, where <code>C</code> is the result of <code>tensoradd!(C, pC, A, conjA)</code> with scalar type <code>TC</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/9975b3139399ad4c05a63e298433d5b099e15b5f/src/interface.jl#L96-L101">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TensorOperations.tensoradd_structure" href="#TensorOperations.tensoradd_structure"><code>TensorOperations.tensoradd_structure</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tensoradd_structure(pC, A, conjA)</code></pre><p>Obtain the structure information of <code>C</code>, where <code>C</code> would be the output of <code>tensoradd!(C, pC, A, conjA)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/9975b3139399ad4c05a63e298433d5b099e15b5f/src/interface.jl#L80-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TensorOperations.tensorcontract_type" href="#TensorOperations.tensorcontract_type"><code>TensorOperations.tensorcontract_type</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tensorcontract_type(TC, pC, A, pA, conjA, B, pB, conjB)</code></pre><p>Obtain <code>typeof(C)</code>, where <code>C</code> is the result of <code>tensorcontract!(C, pC, A, pA, conjA, B, pB, conjB)</code> with scalar type <code>TC</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/9975b3139399ad4c05a63e298433d5b099e15b5f/src/interface.jl#L104-L109">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TensorOperations.tensorcontract_structure" href="#TensorOperations.tensorcontract_structure"><code>TensorOperations.tensorcontract_structure</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tensorcontract_structure(pC, A, pA, conjA, B, pB, conjB)</code></pre><p>Obtain the structure information of <code>C</code>, where <code>C</code> would be the output of <code>tensorcontract!(C, pC, A, pA, conjA, B, pB, conjB)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/9975b3139399ad4c05a63e298433d5b099e15b5f/src/interface.jl#L88-L93">source</a></section></article><p>Finally, the tensor is allocated, where a flag indicates if this is a temporary object, or one that will persist outside of the scope of the macro. If the resulting tensor is a temporary object and its memory will not be freed by Julia&#39;s garbage collector, it can be explicitly freed by implementing <code>tensorfree!</code>, which by default does nothing.</p><article class="docstring"><header><a class="docstring-binding" id="TensorOperations.tensoralloc" href="#TensorOperations.tensoralloc"><code>TensorOperations.tensoralloc</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tensoralloc(ttype, structure, istemp=false, [backend::Backend])</code></pre><p>Allocate memory for a tensor of type <code>ttype</code> and structure <code>structure</code>. The optional third argument can be used to indicate that the result is used as a temporary tensor, for which in some cases and with some backends (the optional foruth argument) a different allocation strategy might be used.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/9975b3139399ad4c05a63e298433d5b099e15b5f/src/interface.jl#L112-L119">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TensorOperations.tensorfree!" href="#TensorOperations.tensorfree!"><code>TensorOperations.tensorfree!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tensorfree!(C)</code></pre><p>Provide a hint that the allocated memory of <code>C</code> can be released.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/9975b3139399ad4c05a63e298433d5b099e15b5f/src/interface.jl#L122-L126">source</a></section></article><p>The <code>@tensor</code> macro will however only insert the calls to the following functions, which have a default implementation in terms of the functions above.</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>TensorOperations.tensoralloc_add</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>TensorOperations.tensoralloc_contract</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Utility"><a class="docs-heading-anchor" href="#Utility">Utility</a><a id="Utility-1"></a><a class="docs-heading-anchor-permalink" href="#Utility" title="Permalink"></a></h2><p>Some of the optional keywords for <code>@tensor</code> can be accessed only after implementing the following utility functions:</p><article class="docstring"><header><a class="docstring-binding" id="TensorOperations.tensorcost" href="#TensorOperations.tensorcost"><code>TensorOperations.tensorcost</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">tensorcost(A, i)</code></pre><p>Compute the contraction cost associated with the <code>i</code>th index of a tensor, such that the total cost of a pairwise contraction is found as the product of the costs of all contracted indices and all uncontracted indices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/9975b3139399ad4c05a63e298433d5b099e15b5f/src/interface.jl#L133-L139">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TensorOperations.checkcontractible" href="#TensorOperations.checkcontractible"><code>TensorOperations.checkcontractible</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">checkcontractible(A, iA, conjA, B, iB, conjB, label)</code></pre><p>Verify whether two tensors <code>opA(A)</code> and <code>opB(B)</code> are compatible for having their  respective index <code>iA</code> and <code>iB</code> contracted, and throws an error if not. The operation <code>opA</code> acts as <code>identity</code> if <code>conjA</code> equals <code>:N</code> and as <code>conj</code> if <code>conjA</code> equals <code>:C</code>; the operation <code>opB</code> is determined by <code>conjB</code> analogously.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Jutho/TensorOperations.jl/blob/9975b3139399ad4c05a63e298433d5b099e15b5f/src/interface.jl#L142-L149">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../functions/">« Functions</a><a class="docs-footer-nextpage" href="../implementation/">Implementation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Sunday 16 July 2023 16:09">Sunday 16 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
